-- £adowanie danych z tabeli HIVE: geolocation 
a = LOAD 'geolocation' using org.apache.hive.hcatalog.pig.HCatLoader();
b = filter a by event != 'normal';
c = foreach b generate driverid, event, (int) '1' as occurance;
---dump c;
d = group c by driverid;
--dump d;
e = foreach d generate group as driverid, SUM(c.occurance) as total_occureences;
--dump e;
g = LOAD 'DriverMileage' using org.apache.hive.hcatalog.pig.HCatLoader();
h = join e by driverid, g by driverid;
--DUMP h;
final_data = foreach h generate $0 as driverid, $1 as events, $3 as totmiles, (float) $3 / $1 as riskfactor;
--DUMP final_data;
--store final_data into 'riskfactor' using org.apache.hive.hcatalog.pig.HCatStorer();